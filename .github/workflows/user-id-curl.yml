on:
  push:
    tags:
      - "*"
  workflow_dispatch:

jobs:
  user-id-curl:
    runs-on: ubuntu-latest
    name: user-id-curl
    env:
      URL_USER_API: ${{ GITHUB_API_URL }}/users/${{ github.repository_owner }}

    steps:
      - name: Set COMMIT_USER_ID - Curl API
        uses: actions/github-script@v4
        id: commit_user_id
        run: |
          COMMIT_USER_ID="$( curl --request GET \
            --url "${URL_USER_API}"
            --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}'
            --header 'content-type: application/json' | grep '"id"' | awk '{print $2}' | sed 's/,//' )"
          echo "::set-output name=COMMIT_USER_ID::${COMMIT_USER_ID}"
      - name: Get COMMIT_USER_ID
        run: echo "${{ steps.commit_user_id.outputs.COMMIT_USER_ID }}"
